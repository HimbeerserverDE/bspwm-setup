#! /bin/bash

set -e

function command_exists {
	command -v $1 &> /dev/null
}

if [ ${UID} -ne 0 ]; then
	if command_exists doas; then
		SUDO="doas"
	elif command_exists sudo; then
		SUDO="sudo"
	else
		echo "Requires doas or sudo to be installed."
		exit 1
	fi
fi

# Get all arguments excluding the lastone
ARGSLEN=$(($#-1))
ARGS=${@:1:${ARGSLEN}}

# Get last argument
for LAST; do true; done

${SUDO} pacman -R ${ARGS} ${LAST}

# Need write permissions to delete without root privileges
chmod -R u+w ~/aur/${LAST}
rm -rf ~/aur/${LAST}
